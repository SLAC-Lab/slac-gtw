diff --git a/advpoll.module b/advpoll.module
index b43fee1..3dc91a7 100644
--- a/advpoll.module
+++ b/advpoll.module
@@ -495,25 +495,48 @@ function advpoll_display_results($nid, $data, $page = 0) {
         $show_bar = _advpoll_show_writeins_access();
       }
 
-      if ($show_bar) {
-        $bars .= theme('advpoll_bar', array(
-          'title' => $title,
-          'percentage' => $item['percentage'],
-          'votes' => $item['votes'],
-          'voted' => $voted,
-          )
-        );
-      }
-    }
-
-    $output .= theme('advpoll_results', array(
-      'bars' => $bars,
-      'total' => $results['total'],
-      'voted' => $votes,
-      'nid' => $nid,
-      'cancel_form' => $rendered_form,
-      )
-    );
+       // Get the total votes for all write in
+       $count = 1;
+       $where_statement = '';
+       $writein_percentage = '';
+       $writein_total = '';
+       foreach ($data->choices as $choice) {
+         if ($choice['write_in'] == 1) {
+           if ($count == 1) {
+             $where_statement .= 'tag=\''. $choice['choice_id'] . '\'';
+           } else {
+             $where_statement .= ' OR tag=\'' . $choice['choice_id'] . '\'';
+           }
+           $count++;
+         }
+       }
+       $result = db_query('SELECT SUM(value) as count FROM votingapi_cache WHERE (' . $where_statement . ') AND function=\'count\'');
+       foreach ($result as $record) {
+         $writein_percentage = ceil((($record->count)*100)/$results['total']);
+         $writein_total = $record->count;
+       }
+ 
+       if ($show_bar) {
+         $bars .= theme('advpoll_bar', array(
+           'title' => $title,
+           'percentage' => $item['percentage'],
+           'votes' => $item['votes'],
+           'voted' => $voted,
+           )
+         );
+       }
+     }
+ 
+     $output .= theme('advpoll_results', array(
+       'bars' => $bars,
+       'total' => $results['total'],
+       'voted' => $votes,
+       'nid' => $nid,
+       'cancel_form' => $rendered_form,
+       'writein_percentage' => $writein_percentage,
+       'writein_total' => $writein_total,
+       )
+     );
   }
 
   return $output;
@@ -893,17 +916,27 @@ function advpoll_process_writein($nid, $writein, $data) {
   if ($node) {
     $lang = entity_language('node', $node);
     $node_choices = $node->advpoll_choice[$lang];
+
     $writein_choice = array(
       'choice' => $writein,
       'write_in' => 1,
       'choice_id' => $id,
     );
 
-    $node_choices[] = $writein_choice;
-    $node->advpoll_choice[$lang] = $node_choices;
-    node_save($node);
-  }
+    $choice_exists = false;
+    foreach ($node_choices as $c) {
+      if (strtolower($writein === strtolower($c['choice']))){
+        $writein_choice = $c;
+        $choice_exists = true;
+      }
+    }
 
+    if (!$choice_exists) {
+      $node_choices[] = $writein_choice;
+      $node->advpoll_choice[$lang] = $node_choices;
+      node_save($node);
+    }
+  }
   return $writein_choice;
 }
 
diff --git a/includes/advpoll_voteapi.inc b/includes/advpoll_voteapi.inc
index 75d031a..16c34dd 100755
--- a/includes/advpoll_voteapi.inc
+++ b/includes/advpoll_voteapi.inc
@@ -394,7 +394,6 @@ function advpoll_checkbox_selected($choices, $votes) {
  *   The unique ID of the choice selected by the user.
  */
 function advpoll_radio_selected($choices, $vote) {
-
   $selected = array();
   $count = count($choices);
 
@@ -405,8 +404,7 @@ function advpoll_radio_selected($choices, $vote) {
       $selected[] = $choices[$i]['choice_id'];
     }
   }
-
-  return $selected;
+  return array_unique($selected);
 }
 
 /**
